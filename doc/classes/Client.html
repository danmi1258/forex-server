<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Client</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/Client.html">Client</a></li>
            
                <li><a href="../classes/Default.html">Default</a></li>
            
                <li><a href="../classes/Order.html">Order</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1>Client Class</h1>
<div class="box meta">
    

    
        <div class="extends">
            Extends <a href="../classes/Default.html" class="crosslink">Default</a>
        </div>
    

    
        <div class="foundat">
            Defined in: <a href="../files/_home_sergey_WebstormProjects_myProjects_forex-server_app_models_client.js.html#l18"><code>&#x2F;home&#x2F;sergey&#x2F;WebstormProjects&#x2F;myProjects&#x2F;forex-server&#x2F;app&#x2F;models&#x2F;client.js:18</code></a>
        </div>
    

    

    
</div>



<div class="box intro">
    
</div>



<div id="classdocs" class="tabview">
    <ul class="api-class-tabs">
        <li class="api-class-tab index"><a href="#index">Index</a></li>

        
            <li class="api-class-tab methods"><a href="#methods">Methods</a></li>
        
        
        
        
    </ul>

    <div>
        <div id="index" class="api-class-tabpanel index">
            <h2 class="off-left">Item Index</h2>

            
                <div class="index-section methods">
                    <h3>Methods</h3>

                    <ul class="index-list methods extends">
                        
                            <li class="index-item method">
                                <a href="#method__handleProviderClosedOrders">_handleProviderClosedOrders</a>

                                
                                
                            </li>
                        
                            <li class="index-item method">
                                <a href="#method__handleProviderNewOrders">_handleProviderNewOrders</a>

                                
                                
                            </li>
                        
                            <li class="index-item method">
                                <a href="#method_addToOrderHistory">addToOrderHistory</a>

                                
                                
                            </li>
                        
                            <li class="index-item method">
                                <a href="#method_alreadySubscribed">alreadySubscribed</a>

                                
                                
                            </li>
                        
                            <li class="index-item method">
                                <a href="#method_changeToken">changeToken</a>

                                
                                
                            </li>
                        
                            <li class="index-item method">
                                <a href="#method_checkOnChange">checkOnChange</a>

                                
                                
                            </li>
                        
                            <li class="index-item method">
                                <a href="#method_closeOrder">closeOrder</a>

                                
                                
                            </li>
                        
                            <li class="index-item method">
                                <a href="#method_create">create</a>

                                
                                    <span class="flag static">static</span>
                                
                                
                            </li>
                        
                            <li class="index-item method">
                                <a href="#method_createOrder">createOrder</a>

                                
                                
                            </li>
                        
                            <li class="index-item method">
                                <a href="#method_createOrderAnalitic">createOrderAnalitic</a>

                                
                                
                            </li>
                        
                            <li class="index-item method">
                                <a href="#method_getByTid">getByTid</a>

                                
                                    <span class="flag static">static</span>
                                
                                
                            </li>
                        
                            <li class="index-item method">
                                <a href="#method_getOrderByTicket">getOrderByTicket</a>

                                
                                
                            </li>
                        
                            <li class="index-item method">
                                <a href="#method_getOrders">getOrders</a>

                                
                                
                            </li>
                        
                            <li class="index-item method">
                                <a href="#method_getSubscribers">getSubscribers</a>

                                
                                
                            </li>
                        
                            <li class="index-item method">
                                <a href="#method_getSubscribtions">getSubscribtions</a>

                                
                                
                            </li>
                        
                            <li class="index-item method">
                                <a href="#method_handleProviderTerminalMessage">handleProviderTerminalMessage</a>

                                
                                
                            </li>
                        
                            <li class="index-item method">
                                <a href="#method_subscribe">subscribe</a>

                                
                                
                            </li>
                        
                            <li class="index-item method">
                                <a href="#method_unsubscribe">unsubscribe</a>

                                
                                
                            </li>
                        
                    </ul>
                </div>
            

            

            

            
        </div>

        
            <div id="methods" class="api-class-tabpanel">
                <h2 class="off-left">Methods</h2>

                
                    <div id="method__handleProviderClosedOrders" class="method item">
    <h3 class="name"><code>_handleProviderClosedOrders</code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>masterOrders</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    

    

    

    

    
        <span class="flag async">async</span>
    

    <div class="meta">
        
            
                
                <p>
                
                Defined in
                
            
        
        
        <a href="../files/_home_sergey_WebstormProjects_myProjects_forex-server_app_models_client.js.html#l911"><code>&#x2F;home&#x2F;sergey&#x2F;WebstormProjects&#x2F;myProjects&#x2F;forex-server&#x2F;app&#x2F;models&#x2F;client.js:911</code></a>
        
        </p>


        

        
    </div>

    <div class="description">
        <h1 id="-">Обработать закрытые ордера</h1>
<p>Входящий параметр <strong>orders</strong> - это массив ордеров на закрытие.</p>
<p>Данный массив можно получить от провайдера, вызвав метод provider.checkOnChange(...).
При этом мы получим в ответе два результирующих массива:</p>
<pre class="code prettyprint"><code>res=[newOrders:[...], closedOrders: [...]];</code></pre>
<p>Массив <strong>[closedOrders]</strong> состоит из списка ордеров провайдера на закрытие. Каждый
ордер имеет уникальный параметр ticket, с помщью которого мы можем выбрать у каждого
подписчика ордер с аналогичным параметром и закрыть его используя метод
<strong>#closeOrder(orderTicket, ...)</strong> , а также включить его в ответ текущего метода.</p>
<p>Т.е. для того чтобы закрыть схожие ордера у подписчиков, в данный метод достаточно
пробросить объекты с единственным полем: <strong>ticket</strong>, а не целые ордера, и этого
будет также достаточно для успешного завершения работы метода.</p>
<p>Для каждого подписчика закроет указанные ордера. При этом ордер будет удален из списка
открытых ордеров <strong>client.openedOrders</strong></p>
<h2 id="-">Формат возвращаемых данных:</h2>
<pre class="code prettyprint"><code>res = [{
    subscriber: Client,
    order: Order,
    tid: subscriber.tid,
    action: &quot;close&quot;,
    data: {
        ticket Integer
    }
}]</code></pre>

    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">masterOrders</code>
                        <span class="type">Array</span>
                    

                    

                    <div class="param-description">
                        <p>list of the mater orders (instance of Order) to close</p>

                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">err</code>
                                    <span class="type">Error</span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">res</code>
                                    <span class="type">Array</span>
                                

                                <div class="param-description">
                                    <p>see above</p>

                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
                    <div id="method__handleProviderNewOrders" class="method item">
    <h3 class="name"><code>_handleProviderNewOrders</code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>orders</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>expanded</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    

    

    

    

    
        <span class="flag async">async</span>
    

    <div class="meta">
        
            
                
                <p>
                
                Defined in
                
            
        
        
        <a href="../files/_home_sergey_WebstormProjects_myProjects_forex-server_app_models_client.js.html#l1079"><code>&#x2F;home&#x2F;sergey&#x2F;WebstormProjects&#x2F;myProjects&#x2F;forex-server&#x2F;app&#x2F;models&#x2F;client.js:1079</code></a>
        
        </p>


        

        
    </div>

    <div class="description">
        <h1 id="-">Обработка списка новых ордеров</h1>
<p>Для каждого подписчика вызывает метод <strong>#createOrderAnalitic</strong> для каждого ордера
из списка полученных ордеров на открытие.</p>
<p>В данном методе список полученных ордеров на открытие - нативные сообщения от терминала,
а не оредра из БД.</p>
<h2 id="-">Формат возвращаемых данных:</h2>
<pre class="code prettyprint"><code>res = [{
        subscriber: Client,
        tid: subscriber.tid,
        order: Order,
        action: &quot;create&quot;,
        data: {
            ticket: null
            type Ineger
            symbol String
            lots Double
            comment String
        }
    }]</code></pre>

    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">orders</code>
                        <span class="type">Array</span>
                    

                    

                    <div class="param-description">
                        <p>open orders from terminal message</p>

                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">err</code>
                                    <span class="type">Error</span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">expanded</code>
                        <span class="type">Res</span>
                    

                    

                    <div class="param-description">
                        <p>response. See above</p>

                    </div>

                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
                    <div id="method_addToOrderHistory" class="method item">
    <h3 class="name"><code>addToOrderHistory</code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>ticket</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>tOrder</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    

    

    

    

    
        <span class="flag async">async</span>
    

    <div class="meta">
        
            
                
                <p>
                
                Defined in
                
            
        
        
        <a href="../files/_home_sergey_WebstormProjects_myProjects_forex-server_app_models_client.js.html#l1163"><code>&#x2F;home&#x2F;sergey&#x2F;WebstormProjects&#x2F;myProjects&#x2F;forex-server&#x2F;app&#x2F;models&#x2F;client.js:1163</code></a>
        
        </p>


        

        
    </div>

    <div class="description">
        <h1 id="-">Добавить историю сделки</h1>
<p>Метод получает данные терминала в исходном виде и добавляет их в историю указанного 
ордера <strong>Order.history</strong>.</p>
<p>Если данные не изменились с последнего раза, добавления в историю не произойдет.</p>

    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">ticket</code>
                        <span class="type">Number</span>
                    

                    

                    <div class="param-description">
                        <p>terminal&#39;s order ticket</p>

                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">tOrder</code>
                        <span class="type">Object</span>
                    

                    

                    <div class="param-description">
                        <p>plain terminal object</p>

                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">err</code>
                                    <span class="type">Error</span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">res</code>
                                    <span class="type"><a href="../classes/Order.html" class="crosslink">Order</a></span>
                                

                                <div class="param-description">
                                    <p>updated order (instance of Order)</p>

                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
                    <div id="method_alreadySubscribed" class="method item">
    <h3 class="name"><code>alreadySubscribed</code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>provider</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    
        <span class="returns-inline">
            <span class="type">Boolean</span>
        </span>
    

    

    

    

    

    

    

    <div class="meta">
        
            
                
                <p>
                
                Defined in
                
            
        
        
        <a href="../files/_home_sergey_WebstormProjects_myProjects_forex-server_app_models_client.js.html#l139"><code>&#x2F;home&#x2F;sergey&#x2F;WebstormProjects&#x2F;myProjects&#x2F;forex-server&#x2F;app&#x2F;models&#x2F;client.js:139</code></a>
        
        </p>


        

        
    </div>

    <div class="description">
        <h1 id="-">Проверить на существующую подписку</h1>
<p>Метод проверит существует ли подписка на заданный клиент-провайдер.</p>
<p>В случае, если подписка на данного провайдера у текущего терминала уже есть, вернет true</p>

    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">provider</code>
                        <span class="type">Object</span>
                    

                    

                    <div class="param-description">
                        <p>-клиент провайдер</p>

                    </div>

                    
                </li>
            
            </ul>
        </div>
    

    
        <div class="returns">
            <h4>Returns:</h4>

            <div class="returns-description">
                
                    
                        <span class="type">Boolean</span>:
                    
                    <p>true | false</p>

                
            </div>
        </div>
    

    
</div>

                
                    <div id="method_changeToken" class="method item">
    <h3 class="name"><code>changeToken</code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>token</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    

    

    

    

    
        <span class="flag async">async</span>
    

    <div class="meta">
        
            
                
                <p>
                
                Defined in
                
            
        
        
        <a href="../files/_home_sergey_WebstormProjects_myProjects_forex-server_app_models_client.js.html#l242"><code>&#x2F;home&#x2F;sergey&#x2F;WebstormProjects&#x2F;myProjects&#x2F;forex-server&#x2F;app&#x2F;models&#x2F;client.js:242</code></a>
        
        </p>


        

        
    </div>

    <div class="description">
        <h1 id="-">Изменить токен</h1>
<p>Метод изменяет токен для текущего клиента.
Токен может быть назначен только из таблицы существующих токенов.
Токен должен быть:</p>
<ul>
<li>существующим</li>
<li>активным</li>
<li>свободным (не использованным)</li>
</ul>

    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">token</code>
                        <span class="type">Token</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">err</code>
                                    <span class="type">Error</span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">res</code>
                                    <span class="type"><a href="../classes/Client.html" class="crosslink">Client</a></span>
                                

                                <div class="param-description">
                                    <p>-текущий объект клиента</p>

                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
                    <div id="method_checkOnChange" class="method item">
    <h3 class="name"><code>checkOnChange</code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>orderList</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>options</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>states</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    

    

    

    

    
        <span class="flag async">async</span>
    

    <div class="meta">
        
            
                
                <p>
                
                Defined in
                
            
        
        
        <a href="../files/_home_sergey_WebstormProjects_myProjects_forex-server_app_models_client.js.html#l678"><code>&#x2F;home&#x2F;sergey&#x2F;WebstormProjects&#x2F;myProjects&#x2F;forex-server&#x2F;app&#x2F;models&#x2F;client.js:678</code></a>
        
        </p>


        

        
    </div>

    <div class="description">
        <h1 id="-">Проверить на обновления</h1>
<p>Метод получает список открытых позиций и сравнивает с уже открытыми ордерами.
Возвращает информацию с отличиями.</p>
<p>Если отличий нет, будут возвращены пустые массивы.</p>
<p>В опциях можно передать параметр <strong>states</strong>, список статусов ордеров, которые будут
задействованы в сравнении.</p>
<h2 id="-orderlist-message-data-">Хэш сообщения от терминала orderList (message.data)</h2>
<pre class="code prettyprint"><code>orderList = [{
    symbol: String
    type: Integer
    lots: Double
    open-time: Number (Int timestamp linux)
    open-price: Number (Double)
    swap: Number Double
    profit: Double
    take-profit: Double
}]</code></pre>
<h2 id="res-">res: возвращаемые данные</h2>
<pre class="code prettyprint"><code>newOrders = [{
    ticket: Integer
    symbol: String
    type: Integer
    lots: Double
    open-time: Number (Int timestamp linux)
    open-price: Number (Double)
    swap: Number Double
    profit: Double
    take-profit: Double
}, ...]

closedOrders = [{instance of Order}, ...]</code></pre>

    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">orderList</code>
                        <span class="type">Object</span>
                    

                    

                    <div class="param-description">
                        <p>native terminal message</p>

                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">options</code>
                        <span class="type">Object</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">states</code>
                        <span class="type">Array</span>
                    

                    

                    <div class="param-description">
                        <p>options.states. List of the order states will be included in result.</p>

                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">err</code>
                                    <span class="type">Error</span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">res</code>
                                    <span class="type">Object</span>
                                

                                <div class="param-description">
                                    <p><em>see above</em></p>

                                </div>

                                
                                    <ul class="params-list">
                                        
                                        <li class="param">
                                            
                                                <code class="param-name">newOrders</code>
                                                <span class="type">Array</span>
                                            

                                            <div class="param-description">
                                                
                                            </div>
                                        </li>
                                        
                                        <li class="param">
                                            
                                                <code class="param-name">closedOrders</code>
                                                <span class="type">Array</span>
                                            

                                            <div class="param-description">
                                                
                                            </div>
                                        </li>
                                        
                                    </ul>
                                
                            </li>
                            
                        </ul>
                    
                </li>
            
            </ul>
        </div>
    

    

    
        <div class="example">
            <h4>Example:</h4>

            <div class="example-content">
                <pre class="code prettyprint"><code>// Ордер в статусе __OPENED__ попадет в список closedOrders

var order1 = {
    ticket: 123,
    state: 12,
    ...
}

// orderList не имеет в списке объекта с ticket=123

client.checkOnChange({ticket: 123, ...}, function(err, res) {
    res.closedOrders = [{order(with ticket=123)}, ...]
})

// Ордер в статусе __OPENING не попадет всписок closedOrders

var order1 = {
    ticket: 123,
    state: 11,
    ...
}

// orderList не имеет в списке объекта с ticket=123

client.checkOnChange({ticket: 123, ...}, function(err, res) {
    // assert(res.closedOrder.indexOf(order(with ticket=123)) === -1, true]
})</code></pre>

            </div>
        </div>
    
</div>

                
                    <div id="method_closeOrder" class="method item">
    <h3 class="name"><code>closeOrder</code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>order</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>options</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    

    

    

    

    
        <span class="flag async">async</span>
    

    <div class="meta">
        
            
                
                <p>
                
                Defined in
                
            
        
        
        <a href="../files/_home_sergey_WebstormProjects_myProjects_forex-server_app_models_client.js.html#l473"><code>&#x2F;home&#x2F;sergey&#x2F;WebstormProjects&#x2F;myProjects&#x2F;forex-server&#x2F;app&#x2F;models&#x2F;client.js:473</code></a>
        
        </p>


        

        
    </div>

    <div class="description">
        <h1 id="-">Закрыть ордер</h1>
<p>Метод закрывает ранее открытый ордер. По умолчанию статус ордера будет <strong>CLOSING (21)</strong></p>
<p>Для закрытия с подтверждением используейте опцию <strong>confirm</strong>.
При этом ордер получит статус <strong>CLOSED (22)</strong>, а также id ордера будет удален из
списка открытых ордеров <strong>@openOrders</strong> текущего клиента.</p>

    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">order</code>
                        <span class="type"><a href="../classes/Order.html" class="crosslink">Order</a></span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">options</code>
                        <span class="type">Object</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">confirm</code>
                                    <span class="type">Boolean</span>
                                

                                <div class="param-description">
                                    <ul>
<li>if true then closed order will be confirmed imediatly</li>
</ul>

                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">err</code>
                                    <span class="type">Error</span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">res</code>
                                    <span class="type"><a href="../classes/Order.html" class="crosslink">Order</a></span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
                    <div id="method_create" class="method item">
    <h3 class="name"><code>create</code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>data</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    

    

    
        <span class="flag static">static</span>
    

    

    
        <span class="flag async">async</span>
    

    <div class="meta">
        
            
                
                <p>
                
                Defined in
                
            
        
        
        <a href="../files/_home_sergey_WebstormProjects_myProjects_forex-server_app_models_client.js.html#l55"><code>&#x2F;home&#x2F;sergey&#x2F;WebstormProjects&#x2F;myProjects&#x2F;forex-server&#x2F;app&#x2F;models&#x2F;client.js:55</code></a>
        
        </p>


        

        
    </div>

    <div class="description">
        <h1 id="-">Создать терминал</h1>
<p>Создает новый терминал.</p>

    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">data</code>
                        <span class="type">Object</span>
                    

                    

                    <div class="param-description">
                        <p>see: class property</p>

                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">err</code>
                                    <span class="type">Error</span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">client</code>
                                    <span class="type">Object</span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
            </ul>
        </div>
    

    

    
        <div class="example">
            <h4>Example:</h4>

            <div class="example-content">
                <pre class="code prettyprint"><code>var values = {
    name: &#39;test terminal&#39;,
    type: &#39;provider&#39;,
    tid: &#39;12345&#39;
}

Client.crete(values, function(err, client) {
    // client will be an object instance of Client
})</code></pre>

            </div>
        </div>
    
</div>

                
                    <div id="method_createOrder" class="method item">
    <h3 class="name"><code>createOrder</code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>values</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>options</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    

    

    

    

    
        <span class="flag async">async</span>
    

    <div class="meta">
        
            
                
                <p>
                
                Defined in
                
            
        
        
        <a href="../files/_home_sergey_WebstormProjects_myProjects_forex-server_app_models_client.js.html#l328"><code>&#x2F;home&#x2F;sergey&#x2F;WebstormProjects&#x2F;myProjects&#x2F;forex-server&#x2F;app&#x2F;models&#x2F;client.js:328</code></a>
        
        </p>


        

        
    </div>

    <div class="description">
        <h1 id="-">Создать запись о новом ордере</h1>
<p>Методы создает новую запись в таблице orders, привязывая его к текущему клиенту.</p>
<p>Используйте этот метод, когда хотите инициировать создание нового ордера со стороны сервера.</p>
<p>По умочанию метод создает новый ордер в статусе <strong>CREATING (11)</strong>.
Для создания ордера в статусе <strong>CREATED (12)</strong> необходимо передать в опциях параметр
<strong>@confirm</strong>. При этом ордер также будет добавлен в свойство <strong>@openOrders</strong> текущего
клиента.</p>
<p>Минимальные свойства сообщения __@values</p>
<pre class="code prettyprint"><code>* type
* symbol
* lots
* comment</code></pre>

    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">values</code>
                        <span class="type">Object</span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>plain terminal message. see above</li>
</ul>

                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">options</code>
                        <span class="type">Object</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">err</code>
                                    <span class="type">Error</span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">res</code>
                                    <span class="type"><a href="../classes/Order.html" class="crosslink">Order</a></span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
                    <div id="method_createOrderAnalitic" class="method item">
    <h3 class="name"><code>createOrderAnalitic</code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>data</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>expanded</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    

    

    

    

    
        <span class="flag async">async</span>
    

    <div class="meta">
        
            
                
                <p>
                
                Defined in
                
            
        
        
        <a href="../files/_home_sergey_WebstormProjects_myProjects_forex-server_app_models_client.js.html#l1016"><code>&#x2F;home&#x2F;sergey&#x2F;WebstormProjects&#x2F;myProjects&#x2F;forex-server&#x2F;app&#x2F;models&#x2F;client.js:1016</code></a>
        
        </p>


        

        
    </div>

    <div class="description">
        <h1 id="-">Открыть ордер с аналитикой</h1>
<p>Метод получает данные от терминала и анализирует их. При положительном решении
открывает новый ордер.</p>
<p>В данном методе необходимо инкапсулировать все логические функции (order open middlware)
которые принимают решение для открытия нового ордера.</p>
<h2 id="-">Формат возвращаемых данных</h2>
<p>res = {
    order: {Order},
    data: {
        ticket Integer,
        type Integer
        symbol String
        lots Double
        comment String
    }
}</p>

    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">data</code>
                        <span class="type">Object</span>
                    

                    

                    <div class="param-description">
                        <p>plain terminal message.</p>

                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">err</code>
                                    <span class="type">Error</span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">expanded</code>
                        <span class="type">Object</span>
                    

                    

                    <div class="param-description">
                        <p>response</p>

                    </div>

                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
                    <div id="method_getByTid" class="method item">
    <h3 class="name"><code>getByTid</code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>tid</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    

    

    
        <span class="flag static">static</span>
    

    

    
        <span class="flag async">async</span>
    

    <div class="meta">
        
            
                
                <p>
                
                Defined in
                
            
        
        
        <a href="../files/_home_sergey_WebstormProjects_myProjects_forex-server_app_models_client.js.html#l100"><code>&#x2F;home&#x2F;sergey&#x2F;WebstormProjects&#x2F;myProjects&#x2F;forex-server&#x2F;app&#x2F;models&#x2F;client.js:100</code></a>
        
        </p>


        

        
    </div>

    <div class="description">
        <h1 id="-tid">Получить клиент по свойству @tid</h1>
<p>Метод производит поиск по свойству <strong>client.tid</strong>.</p>
<p>В случае если клиент не найден, вернет null</p>

    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">tid</code>
                        <span class="type">Number</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">err</code>
                                    <span class="type">Error</span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">client</code>
                                    <span class="type"><a href="../classes/Client.html" class="crosslink">Client</a></span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
            </ul>
        </div>
    

    

    
        <div class="example">
            <h4>Example:</h4>

            <div class="example-content">
                <pre class="code prettyprint"><code>// клиент с tid = 123 существует
Client.getByTid(123, function(err, client) {
    // client = {tid: 123, ...}
})

// клиет с tid = 123 не существует
Client.getByTid(123, function(err, client) {
    // err=null, client = null
})</code></pre>

            </div>
        </div>
    
</div>

                
                    <div id="method_getOrderByTicket" class="method item">
    <h3 class="name"><code>getOrderByTicket</code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>ticket</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    

    

    

    

    
        <span class="flag async">async</span>
    

    <div class="meta">
        
            
                
                <p>
                
                Defined in
                
            
        
        
        <a href="../files/_home_sergey_WebstormProjects_myProjects_forex-server_app_models_client.js.html#l626"><code>&#x2F;home&#x2F;sergey&#x2F;WebstormProjects&#x2F;myProjects&#x2F;forex-server&#x2F;app&#x2F;models&#x2F;client.js:626</code></a>
        
        </p>


        

        
    </div>

    <div class="description">
        <h1 id="-">Найти ордер по тикету</h1>
<p>Найдет ордер по его тикету.</p>
<p>В случае, если ордер не найден, будет возвращен результат null</p>

    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">ticket</code>
                        <span class="type">Integer</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Functiom</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">err</code>
                                    <span class="type">Error</span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">res</code>
                                    <span class="type"><a href="../classes/Order.html" class="crosslink">Order</a></span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
                    <div id="method_getOrders" class="method item">
    <h3 class="name"><code>getOrders</code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code class="optional">[_options]</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    

    

    

    

    

    <div class="meta">
        
            
                
                <p>
                
                Defined in
                
            
        
        
        <a href="../files/_home_sergey_WebstormProjects_myProjects_forex-server_app_models_client.js.html#l587"><code>&#x2F;home&#x2F;sergey&#x2F;WebstormProjects&#x2F;myProjects&#x2F;forex-server&#x2F;app&#x2F;models&#x2F;client.js:587</code></a>
        
        </p>


        

        
    </div>

    <div class="description">
        <h1 id="-">Получить список ордеров.</h1>
<p>Получает список всех ордеров, закрепленных за данным ордером.</p>
<p>Возможна фильтрация по статусу (состоянию) ордера. Статусы передаются в опциях в виде массива.
Если статусы не переданы, вернет список всех ордеров.</p>

    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name optional">[_options]</code>
                        <span class="type">Object</span>
                        <span class="flag optional" title="This parameter is optional.">optional</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">states</code>
                                    <span class="type">Array</span>
                                

                                <div class="param-description">
                                    <p>-список статусов для фильтрации</p>

                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">err</code>
                                    <span class="type">Error</span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">orders</code>
                                    <span class="type">Array</span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
            </ul>
        </div>
    

    

    
        <div class="example">
            <h4>Example:</h4>

            <div class="example-content">
                <pre class="code prettyprint"><code>client.getOrders({states: [11,12]}, function(err, res) {
    //... res will be all arders with statuses opening (11), opened (12);
})</code></pre>

            </div>
        </div>
    
</div>

                
                    <div id="method_getSubscribers" class="method item">
    <h3 class="name"><code>getSubscribers</code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    

    

    

    

    
        <span class="flag async">async</span>
    

    <div class="meta">
        
            
                
                <p>
                
                Defined in
                
            
        
        
        <a href="../files/_home_sergey_WebstormProjects_myProjects_forex-server_app_models_client.js.html#l297"><code>&#x2F;home&#x2F;sergey&#x2F;WebstormProjects&#x2F;myProjects&#x2F;forex-server&#x2F;app&#x2F;models&#x2F;client.js:297</code></a>
        
        </p>


        

        
    </div>

    <div class="description">
        <h1 id="-">Получить всех подписчиков.</h1>
<p>Позволяет быстро получить все <strong>терминалы консюмеры</strong> (в виде АПИ объектов)
которые подписаны на данный терминал.</p>

    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">err</code>
                                    <span class="type">Error</span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">subscribers</code>
                                    <span class="type">Array</span>
                                

                                <div class="param-description">
                                    <p>-clients</p>

                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
                    <div id="method_getSubscribtions" class="method item">
    <h3 class="name"><code>getSubscribtions</code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    

    

    

    

    
        <span class="flag async">async</span>
    

    <div class="meta">
        
            
                
                <p>
                
                Defined in
                
            
        
        
        <a href="../files/_home_sergey_WebstormProjects_myProjects_forex-server_app_models_client.js.html#l272"><code>&#x2F;home&#x2F;sergey&#x2F;WebstormProjects&#x2F;myProjects&#x2F;forex-server&#x2F;app&#x2F;models&#x2F;client.js:272</code></a>
        
        </p>


        

        
    </div>

    <div class="description">
        <h1 id="-">Получить все подписки.</h1>
<p>Позволяет быстро получить все <strong>терминалы провайдеры</strong> (в виде АПИ объектов)
на которые подписан текущий терминал.</p>
<p>В случае, если ни один терминал не найден, вернет пустой массив.</p>

    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">err</code>
                                    <span class="type">Error</span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">clients</code>
                                    <span class="type">Array</span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
            </ul>
        </div>
    

    

    
        <div class="example">
            <h4>Example:</h4>

            <div class="example-content">
                <pre class="code prettyprint"><code>consumer.getSubscriptions(function(err, res) {
    // ... res = [clients.. ];
})</code></pre>

            </div>
        </div>
    
</div>

                
                    <div id="method_handleProviderTerminalMessage" class="method item">
    <h3 class="name"><code>handleProviderTerminalMessage</code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>openOrders</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    

    

    

    

    
        <span class="flag async">async</span>
    

    <div class="meta">
        
            
                
                <p>
                
                Defined in
                
            
        
        
        <a href="../files/_home_sergey_WebstormProjects_myProjects_forex-server_app_models_client.js.html#l811"><code>&#x2F;home&#x2F;sergey&#x2F;WebstormProjects&#x2F;myProjects&#x2F;forex-server&#x2F;app&#x2F;models&#x2F;client.js:811</code></a>
        
        </p>


        

        
    </div>

    <div class="description">
        <h1 id="-">Обработать сообщение от провайдера</h1>
<p>Методы проводит следующую логику:</p>
<ul>
<li>проверит новые и закрытые ордера</li>
<li>добавит в историю провайдера текущее сообщение от терминала</li>
<li>вызовет метод <strong>#_handleProviderNewOrders</strong> для новых ордеров</li>
<li>вызовет метод <strong>#_handleProviderClosedOrders</strong> для закрытых ордеров</li>
<li>вернет расширенные данные с информацией обо всех событиях</li>
</ul>
<h2 id="-">Формат возвращаемых данных</h2>
<pre class="code prettyprint"><code>res = [{
    subscriber: Client,
    order: Order
    tid: subscriber.tid,
    action: &quot;create|close&quot;,
    data: {
        ticket: action == &quot;create&quot; ? null: Order.ticket
        type Integer
        symbol String
        lots Double
        comment String
    }
}]</code></pre>

    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">openOrders</code>
                        <span class="type">Object</span>
                    

                    

                    <div class="param-description">
                        <p>property from native terminal message type: 10</p>

                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">err</code>
                                    <span class="type">Error</span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">res</code>
                                    <span class="type">Object</span>
                                

                                <div class="param-description">
                                    <p>expanded response. see above</p>

                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
                    <div id="method_subscribe" class="method item">
    <h3 class="name"><code>subscribe</code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>provider</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    

    

    

    

    
        <span class="flag async">async</span>
    

    <div class="meta">
        
            
                
                <p>
                
                Defined in
                
            
        
        
        <a href="../files/_home_sergey_WebstormProjects_myProjects_forex-server_app_models_client.js.html#l157"><code>&#x2F;home&#x2F;sergey&#x2F;WebstormProjects&#x2F;myProjects&#x2F;forex-server&#x2F;app&#x2F;models&#x2F;client.js:157</code></a>
        
        </p>


        

        
    </div>

    <div class="description">
        <h1 id="-">Пописаться на провайдера</h1>
<p>Метод производит подписку терминала типа <em>consumer</em> на терминал типа <em>provider</em>. В любых
других вариациях будет вызвана ошибка:</p>
<pre class="code prettyprint"><code>&#39;[Client #subscribe] error: it is forbidden subscribe on the client with no provider type&#39;</code></pre>
<p>При попытке подписаться на провайдера, на которого уже есть подписка, будет также вызвана
ошибка:</p>
<pre class="code prettyprint"><code>&#39;[Client #subscribe] error: subscriptions already exist&#39;</code></pre>
<p>При удачной подписке у текущего объекта в свойстве <strong>@subscriptions</strong> будет добавлен id
клиента-провайдера.</p>

    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">provider</code>
                        <span class="type">Object</span>
                    

                    

                    <div class="param-description">
                        <p>объект терминала провайдера.</p>

                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">err</code>
                                    <span class="type">Error</span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">client</code>
                                    <span class="type">Object</span>
                                

                                <div class="param-description">
                                    <p>-consumer</p>

                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
            </ul>
        </div>
    

    

    
        <div class="example">
            <h4>Example:</h4>

            <div class="example-content">
                <pre class="code prettyprint"><code>// consumer.type = consumer
// provider.type = provider

client.subscribe(provider, function(err, client) {
    assert(client.subscriptions.indexOf(provier._id) !== -1, true);
})

// повторная подписка приведет к ошибке
client.subscribe(provider, function(err, client) {
    // err != null
})</code></pre>

            </div>
        </div>
    
</div>

                
                    <div id="method_unsubscribe" class="method item">
    <h3 class="name"><code>unsubscribe</code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>provider</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    

    

    

    

    
        <span class="flag async">async</span>
    

    <div class="meta">
        
            
                
                <p>
                
                Defined in
                
            
        
        
        <a href="../files/_home_sergey_WebstormProjects_myProjects_forex-server_app_models_client.js.html#l215"><code>&#x2F;home&#x2F;sergey&#x2F;WebstormProjects&#x2F;myProjects&#x2F;forex-server&#x2F;app&#x2F;models&#x2F;client.js:215</code></a>
        
        </p>


        

        
    </div>

    <div class="description">
        <h1 id="-">Одписаться</h1>
<p>Метод отписывает терминал потребитель от терминала провайдера.</p>
<p>В случае если терминал не имеет подписки на передаваемый провайдер, будет возвращена ошибка:</p>
<pre class="code prettyprint"><code>&#39;[Client #unsubscribe] error: consumer has no subscription on this provider&#39;</code></pre>

    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">provider</code>
                        <span class="type"><a href="../classes/Client.html" class="crosslink">Client</a></span>
                    

                    

                    <div class="param-description">
                        <p>объект терминала провайдера</p>

                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function</span>
                    

                    

                    <div class="param-description">
                         
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">err</code>
                                    <span class="type">Error</span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">res</code>
                                    <span class="type"><a href="../classes/Client.html" class="crosslink">Client</a></span>
                                

                                <div class="param-description">
                                    
                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
            </div>
        

        

        

        
    </div>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
